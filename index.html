<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>æ¨¡æ“¬è¨‚æˆ¿(å››éšæ®µå‹•æ…‹é‡æ¸¬)+T0åŸºæœ¬è³‡æ–™(å°ç£ç‰ˆ)</title>
  <style>
    body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans TC",Arial;padding:20px;line-height:1.6;background:#f5f5f5;max-width:1400px;margin:0 auto}
    .topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;flex-wrap:wrap;gap:12px}
    .card{border:1px solid #e5e7eb;border-radius:12px;padding:16px;margin:12px 0;background:#fff;box-shadow:0 1px 3px rgba(0,0,0,0.1)}
    .row{display:flex;gap:12px;flex-wrap:wrap;}
    .btn{padding:10px 14px;border-radius:10px;border:1px solid #111827;background:#111827;color:#fff;cursor:pointer;font-size:14px;transition:all 0.2s}
    .btn:hover{background:#374151}
    .btn.secondary{background:#fff;color:#111827}
    .btn.secondary:hover{background:#f3f4f6}
    .muted{color:#6b7280;font-size:14px}
    .hidden{display:none}
    .step-title{font-weight:700;font-size:18px;margin-bottom:8px}
    .pill{display:inline-block;padding:2px 8px;border:1px solid #e5e7eb;border-radius:999px;font-size:12px;background:#fff}
    .ok{color:#10b981;font-weight:700}
    select,input[type="text"]{padding:8px;border:1px solid #e5e7eb;border-radius:8px;min-width:220px}
    .w-full{min-width:320px;width:320px}

    /* 7é»é‡è¡¨ */
    .likert{display:grid;grid-template-columns:repeat(7,56px);gap:8px;align-items:flex-start;margin:6px 0;}
    .likert .cell{display:flex;flex-direction:column;align-items:center;font-size:13px;min-height:60px}
    .likert input[type="radio"]{margin:0 0 4px 0;transform:scale(1.1);cursor:pointer}
    .likert .cell span:last-child{display:block;min-height:32px;text-align:center;line-height:1.2;margin-top:2px}
    .qline{display:flex;align-items:center;gap:8px;margin-top:12px}
    .hint{color:#6b7280;font-size:13px;white-space:nowrap}

    /* é£¯åº—è³‡è¨Šå¡ç‰‡ - å›ºå®šé¡¯ç¤ºåœ¨æ‰€æœ‰éšæ®µ */
    .hotel-info-card{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,0.1);margin-bottom:20px}
    
    /* åœ–ç‰‡è¼ªæ’­å€ */
    .carousel-container{position:relative;width:100%;height:500px;overflow:hidden;background:#000}
    .carousel-slides{display:flex;transition:transform 0.4s ease-in-out;height:100%}
    .carousel-slide{min-width:100%;height:100%;display:flex;align-items:center;justify-content:center}
    .carousel-slide img{width:100%;height:100%;object-fit:contain;background:#f5f5f5}
    .carousel-btn{position:absolute;top:50%;transform:translateY(-50%);background:rgba(0,0,0,0.6);color:#fff;border:none;padding:12px 16px;cursor:pointer;font-size:20px;z-index:10;transition:all 0.2s;border-radius:4px}
    .carousel-btn:hover{background:rgba(0,0,0,0.8)}
    .carousel-btn.prev{left:10px}
    .carousel-btn.next{right:10px}
    
    /* ç¸®åœ–å°èˆª */
    .thumbs-nav{display:flex;gap:8px;padding:12px;background:#fafafa;overflow-x:auto;justify-content:center}
    .thumb-item{min-width:100px;width:100px;height:70px;cursor:pointer;border:3px solid transparent;border-radius:8px;overflow:hidden;transition:all 0.2s;background:#fff}
    .thumb-item:hover{transform:scale(1.05);box-shadow:0 2px 8px rgba(0,0,0,0.15)}
    .thumb-item.active{border-color:#059669;box-shadow:0 2px 12px rgba(5,150,105,0.3)}
    .thumb-item img{width:100%;height:100%;object-fit:cover}
    
    /* é£¯åº—è©³ç´°è³‡è¨Š */
    .hotel-details{padding:20px}
    .hotel-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px;flex-wrap:wrap;gap:12px}
    .hotel-title{font-size:22px;font-weight:800;color:#111827;margin-bottom:4px}
    .hotel-subtitle{color:#6b7280;font-size:15px}
    .price-section{text-align:right}
    .price-label{font-size:15px;color:#6b7280;font-weight:500}
    .price-big{font-size:32px;font-weight:800;color:#059669}
    .price-original{font-size:16px;color:#9ca3af;text-decoration:line-through}
    
    .hotel-rating{display:flex;align-items:center;gap:8px;margin:12px 0}
    .stars{color:#f59e0b;font-size:18px}
    .rating-text{color:#6b7280;font-size:14px}
    
    .badges{display:flex;flex-wrap:wrap;gap:8px;margin:16px 0}
    .badge{border:1px solid #86efac;border-radius:999px;padding:6px 12px;font-size:13px;background:#dcfce7;color:#059669}
    .badge.highlight{background:#bbf7d0;border-color:#4ade80;font-weight:600}
    
    .info-row{display:flex;align-items:center;gap:6px;margin:8px 0;color:#374151;font-size:14px}
    .info-row .icon{font-size:16px}
    
    /* å•é¡Œå€åŸŸ */
    .questions-section{background:#f9fafb;padding:20px;border-radius:12px;border:1px solid #e5e7eb}
    .question-card{background:#fff;padding:16px;border-radius:8px;margin:12px 0;border:1px solid #e5e7eb}

    /* T4 é¸é …å¡ç‰‡æ¨£å¼ */
    .slider-option{flex:1;text-align:center;padding:12px;border:2px solid #e5e7eb;border-radius:8px;cursor:pointer;transition:all 0.2s;background:#fff}
    .slider-option:hover{border-color:#059669;background:#f0fdf4}
    .slider-option input[type="radio"]{display:none}

    @media (max-width: 768px){
      .carousel-container{height:350px}
      .hotel-header{flex-direction:column}
      .price-section{text-align:left}
      .thumb-item{min-width:80px;width:80px;height:56px}
    }
  </style>
</head>
<body>

<div class="topbar">
  <h1 style="margin:0">æ¨¡æ“¬è¨‚æˆ¿(å››éšæ®µå‹•æ…‹é‡æ¸¬)</h1>
  <button class="btn hidden" id="btn_export">ğŸ“¥ åŒ¯å‡ºè³‡æ–™(CSV)</button>
</div>
<p class="muted">è«‹ä¾åºå®Œæˆ:<b>T0åŸºæœ¬è³‡æ–™ â†’ T1 â†’ T2 â†’ T3 â†’ T4</b>ã€‚æ¯ä¸€æ­¥åªæœ‰ 1â€”3 é¡Œ,å®Œæˆå¾ŒæŒ‰ä¸‹ä¸€æ­¥ã€‚</p>

<hr style="border:none;border-top:1px solid #e5e7eb;margin:16px 0"/>

<!-- T0 åŸºæœ¬è³‡æ–™ -->
<div id="T0" class="card hidden">
  <div class="step-title">T0 åŸºæœ¬è³‡æ–™ <span class="pill">ç¬¬é›¶æ­¥</span></div>
  
  <p class="muted">ä»¥ä¸‹è³‡æ–™åƒ…åšå­¸è¡“ç ”ç©¶,å»è­˜åˆ¥åŒ–ä¿å­˜ã€‚</p>

  <div class="row">
    <div>
      <div>1) æ€§åˆ¥</div>
      <select id="t0_gender">
        <option value="">è«‹é¸æ“‡</option>
        <option value="male">ç”·æ€§</option>
        <option value="female">å¥³æ€§</option>
        <option value="nonbinary">éäºŒå…ƒæ€§åˆ¥</option>
      </select>
    </div>

    <div>
      <div>2) å¹´é½¡å€é–“</div>
      <select id="t0_age">
        <option value="">è«‹é¸æ“‡</option>
        <option value="18-24">18â€”24 æ­²</option>
        <option value="25-34">25â€”34 æ­²</option>
        <option value="35-44">35â€”44 æ­²</option>
        <option value="45-54">45â€”54 æ­²</option>
        <option value="55+">55 æ­²ä»¥ä¸Š</option>
      </select>
    </div>

    <div>
      <div>3) è·æ¥­</div>
      <select id="t0_job" class="w-full">
        <option value="">è«‹é¸æ“‡</option>
        <option>å­¸ç”Ÿ</option><option>ä¸Šç­æ—</option><option>è‡ªç”±æ¥­</option><option>é€€ä¼‘</option><option>å…¶ä»–</option>
      </select>
    </div>

    <div>
      <div>4) å¹´æ”¶å…¥</div>
      <select id="t0_income">
        <option value="">è«‹é¸æ“‡</option>
        <option value="<50">ä½æ–¼ 50 è¬</option>
        <option value="50-100">50â€”100 è¬</option>
        <option value="100+">100 è¬ä»¥ä¸Š</option>
      </select>
    </div>

    <div>
      <div>5) æ•™è‚²ç¨‹åº¦</div>
      <select id="t0_edu">
        <option value="">è«‹é¸æ“‡</option>
        <option value="high">é«˜ä¸­/é«˜è·</option>
        <option value="college">å¤§å­¸/å¤§å°ˆ</option>
        <option value="grad">ç ”ç©¶æ‰€ä»¥ä¸Š</option>
      </select>
    </div>
  </div>

  <div style="margin-top:12px">
    <button class="btn" id="t0_next">é–‹å§‹å¯¦é©—(é€²å…¥ T1)</button>
  </div>
</div>

<!-- T1 -->
<div id="T1" class="card hidden">
  <div class="step-title">T1 åˆè¦‹åƒ¹æ ¼ <span class="pill">ç¬¬ä¸€æ­¥</span></div>
  
  <div class="questions-section">
    <p style="margin-top:0"><b>ã€é«˜ç´šé›™äººæˆ¿ã€‘</b> ä»Šæ—¥åƒ¹æ ¼ï¼š<b>NT$ 3,241</b> å…ƒ</p>

    <div class="question-card">
      <div class="qline"><b>1) ä½ æƒ³è¦è³¼è²·çš„ç¨‹åº¦ï¼š</b></div>
      <div class="likert">
        <label class="cell"><input type="radio" name="t1_intent_desire" value="1"><span>1</span><span style="font-size:11px;margin-top:2px">å®Œå…¨ä¸æƒ³</span></label>
        <label class="cell"><input type="radio" name="t1_intent_desire" value="2"><span>2</span></label>
        <label class="cell"><input type="radio" name="t1_intent_desire" value="3"><span>3</span></label>
        <label class="cell"><input type="radio" name="t1_intent_desire" value="4"><span>4</span></label>
        <label class="cell"><input type="radio" name="t1_intent_desire" value="5"><span>5</span></label>
        <label class="cell"><input type="radio" name="t1_intent_desire" value="6"><span>6</span></label>
        <label class="cell"><input type="radio" name="t1_intent_desire" value="7"><span>7</span><span style="font-size:11px;margin-top:2px">éå¸¸æƒ³è²·</span></label>
      </div>
    </div>

    <div class="question-card">
      <div class="qline"><b>2) å‡è¨­ç¾åœ¨å°±è¦æ±ºå®šï¼Œä½ æœƒè³¼è²·é€™é–“æˆ¿é–“å—ï¼Ÿ</b></div>
      <div class="likert">
        <label class="cell"><input type="radio" name="t1_intent_action" value="1"><span>1</span><span style="font-size:11px;margin-top:2px">çµ•å°ä¸æœƒ</span></label>
        <label class="cell"><input type="radio" name="t1_intent_action" value="2"><span>2</span></label>
        <label class="cell"><input type="radio" name="t1_intent_action" value="3"><span>3</span></label>
        <label class="cell"><input type="radio" name="t1_intent_action" value="4"><span>4</span></label>
        <label class="cell"><input type="radio" name="t1_intent_action" value="5"><span>5</span></label>
        <label class="cell"><input type="radio" name="t1_intent_action" value="6"><span>6</span></label>
        <label class="cell"><input type="radio" name="t1_intent_action" value="7"><span>7</span><span style="font-size:11px;margin-top:2px">ä¸€å®šæœƒ</span></label>
      </div>
    </div>

    <div class="question-card" style="background:#fff9e6;border:1px solid #fcd34d">
      <div class="qline"><b>âš ï¸ æ³¨æ„åŠ›æª¢æ ¸ï¼šè«‹é¸æ“‡ã€Œ3ã€</b></div>
      <div class="muted" style="margin-bottom:8px">è«‹ä»”ç´°é¸æ“‡æ­£ç¢ºçš„æ•¸å­—</div>
      <div class="likert">
        <label class="cell"><input type="radio" name="attention_check" value="1"><span>1</span></label>
        <label class="cell"><input type="radio" name="attention_check" value="2"><span>2</span></label>
        <label class="cell"><input type="radio" name="attention_check" value="3"><span>3</span><span style="font-size:11px;margin-top:2px;color:#dc2626;font-weight:600">âœ“</span></label>
        <label class="cell"><input type="radio" name="attention_check" value="4"><span>4</span></label>
        <label class="cell"><input type="radio" name="attention_check" value="5"><span>5</span></label>
        <label class="cell"><input type="radio" name="attention_check" value="6"><span>6</span></label>
        <label class="cell"><input type="radio" name="attention_check" value="7"><span>7</span></label>
      </div>
    </div>

    <button class="btn" id="t1_next" style="margin-top:16px">ä¸‹ä¸€æ­¥ â†’</button>
  </div>
</div>

<!-- T2 -->
<div id="T2" class="card hidden">
  <div class="step-title">T2 åƒ¹æ ¼è®Šå‹• <span class="pill">ç¬¬äºŒæ­¥</span></div>
  
  <div class="questions-section">
    <div style="padding:12px;background:#fef2f2;border:1px solid #fca5a5;border-radius:8px;margin-bottom:16px">
      <p style="margin:0;color:#dc2626;font-weight:600">âš ï¸ åƒ¹æ ¼æ›´æ–°ï¼šå¾ NT$ 3,241 â†’ NT$ 3,727 å…ƒ (â†‘ 15%)</p>
    </div>

    <div class="question-card">
      <div class="qline"><b>1) ä½ è¦ºå¾—é€™æ¬¡æ¼²åƒ¹çš„ä¸»å› ï¼š</b></div>
      <div class="likert">
        <label class="cell"><input type="radio" name="t2_locus" value="1"><span>1</span><span style="font-size:11px;margin-top:2px">å¤–åœ¨å› ç´ </span></label>
        <label class="cell"><input type="radio" name="t2_locus" value="2"><span>2</span></label>
        <label class="cell"><input type="radio" name="t2_locus" value="3"><span>3</span></label>
        <label class="cell"><input type="radio" name="t2_locus" value="4"><span>4</span></label>
        <label class="cell"><input type="radio" name="t2_locus" value="5"><span>5</span></label>
        <label class="cell"><input type="radio" name="t2_locus" value="6"><span>6</span></label>
        <label class="cell"><input type="radio" name="t2_locus" value="7"><span>7</span><span style="font-size:11px;margin-top:2px">å…§åœ¨å› ç´ </span></label>
      </div>
    </div>

    <div class="question-card">
      <div class="qline"><b>2) ä½ è¦ºå¾—é€™æ¬¡æ¼²åƒ¹æ˜¯ï¼š</b></div>
      <div class="likert">
        <label class="cell"><input type="radio" name="t2_control" value="1"><span>1</span><span style="font-size:11px;margin-top:2px">ä¸å¯æ§</span></label>
        <label class="cell"><input type="radio" name="t2_control" value="2"><span>2</span></label>
        <label class="cell"><input type="radio" name="t2_control" value="3"><span>3</span></label>
        <label class="cell"><input type="radio" name="t2_control" value="4"><span>4</span></label>
        <label class="cell"><input type="radio" name="t2_control" value="5"><span>5</span></label>
        <label class="cell"><input type="radio" name="t2_control" value="6"><span>6</span></label>
        <label class="cell"><input type="radio" name="t2_control" value="7"><span>7</span><span style="font-size:11px;margin-top:2px">å¯æ§åˆ¶</span></label>
      </div>
    </div>

    <div class="question-card">
      <div class="qline"><b>3) ä½ æ„Ÿåˆ°ä¸é«˜èˆˆçš„ç¨‹åº¦ï¼š</b></div>
      <div class="likert">
        <label class="cell"><input type="radio" name="t2_upset" value="1"><span>1</span><span style="font-size:11px;margin-top:2px">å®Œå…¨ä¸æœƒ</span></label>
        <label class="cell"><input type="radio" name="t2_upset" value="2"><span>2</span></label>
        <label class="cell"><input type="radio" name="t2_upset" value="3"><span>3</span></label>
        <label class="cell"><input type="radio" name="t2_upset" value="4"><span>4</span></label>
        <label class="cell"><input type="radio" name="t2_upset" value="5"><span>5</span></label>
        <label class="cell"><input type="radio" name="t2_upset" value="6"><span>6</span></label>
        <label class="cell"><input type="radio" name="t2_upset" value="7"><span>7</span><span style="font-size:11px;margin-top:2px">éå¸¸ä¸çˆ½</span></label>
      </div>
    </div>

    <button class="btn" id="t2_next">ä¸‹ä¸€æ­¥ â†’</button>
  </div>
</div>

<!-- T3 -->
<div id="T3" class="card hidden">
  <div class="step-title">T3 åƒ¹æ ¼é€æ˜èªªæ˜ <span class="pill">ç¬¬ä¸‰æ­¥</span></div>
  
  <div class="questions-section">
    <div style="padding:16px;background:#eff6ff;border:1px solid #93c5fd;border-radius:8px;margin-bottom:16px;color:#1e40af">
      <b>ğŸ’¡ èªªæ˜ï¼š</b> æœ¬å¹³å°æ¡å‹•æ…‹å®šåƒ¹ï¼Œä¾ã€Œå‰©é¤˜æˆ¿æ•¸ã€è¿‘æœŸç€è¦½é‡ã€åŒå€åŸŸå¹³å‡åƒ¹æ ¼ã€å³æ™‚èª¿æ•´ã€‚ç›®å‰æ­¤æ™‚æ®µï¼šå‰©é¤˜æˆ¿æ•¸æ¸›å°‘ã€ç€è¦½é‡ä¸Šå‡ã€‚
    </div>

    <div class="question-card">
      <div class="qline"><b>1) ç¾åœ¨ä½ è¦ºå¾—åƒ¹æ ¼æ˜¯å…¬å¹³çš„ï¼š</b></div>
      <div class="likert">
        <label class="cell"><input type="radio" name="t3_fair" value="1"><span>1</span><span style="font-size:11px;margin-top:2px">éå¸¸ä¸åŒæ„</span></label>
        <label class="cell"><input type="radio" name="t3_fair" value="2"><span>2</span></label>
        <label class="cell"><input type="radio" name="t3_fair" value="3"><span>3</span></label>
        <label class="cell"><input type="radio" name="t3_fair" value="4"><span>4</span><span style="font-size:11px;margin-top:2px">ä¸­ç«‹</span></label>
        <label class="cell"><input type="radio" name="t3_fair" value="5"><span>5</span></label>
        <label class="cell"><input type="radio" name="t3_fair" value="6"><span>6</span></label>
        <label class="cell"><input type="radio" name="t3_fair" value="7"><span>7</span><span style="font-size:11px;margin-top:2px">éå¸¸åŒæ„</span></label>
      </div>
    </div>

    <div class="question-card">
      <div class="qline"><b>2) ä½ çš„è³¼è²·æ„é¡˜æ˜¯å¦æå‡ï¼š</b></div>
      <div class="likert">
        <label class="cell"><input type="radio" name="t3_intent" value="1"><span>1</span><span style="font-size:11px;margin-top:2px">æ˜é¡¯ä¸‹é™</span></label>
        <label class="cell"><input type="radio" name="t3_intent" value="2"><span>2</span></label>
        <label class="cell"><input type="radio" name="t3_intent" value="3"><span>3</span></label>
        <label class="cell"><input type="radio" name="t3_intent" value="4"><span>4</span><span style="font-size:11px;margin-top:2px">ç„¡è®ŠåŒ–</span></label>
        <label class="cell"><input type="radio" name="t3_intent" value="5"><span>5</span></label>
        <label class="cell"><input type="radio" name="t3_intent" value="6"><span>6</span></label>
        <label class="cell"><input type="radio" name="t3_intent" value="7"><span>7</span><span style="font-size:11px;margin-top:2px">æ˜é¡¯æå‡</span></label>
      </div>
    </div>

    <button class="btn" id="t3_next">é€²å…¥æœ€å¾Œä¸€æ­¥ â†’</button>
  </div>
</div>

<!-- T3_check æ“å¼„æª¢æ ¸ -->
<div id="T3_check" class="card hidden">
  <div class="step-title">ç¢ºèªæ‚¨çš„ç†è§£ <span class="pill">æª¢æ ¸</span></div>
  
  <p class="muted">åœ¨é€²è¡Œæœ€å¾Œæ±ºå®šå‰ï¼Œæˆ‘å€‘æƒ³ç¢ºèªæ‚¨å°å‰›æ‰èªªæ˜çš„ç†è§£ã€‚</p>
  
  <div class="questions-section">
    <div class="question-card">
      <div class="qline"><b>1) æˆ‘ç†è§£å¹³å°ç‚ºä½•èª¿åƒ¹ï¼š</b></div>
      <div class="likert">
        <label class="cell"><input type="radio" name="check_understand" value="1"><span>1</span><span style="font-size:11px;margin-top:2px">å®Œå…¨ä¸ç†è§£</span></label>
        <label class="cell"><input type="radio" name="check_understand" value="2"><span>2</span></label>
        <label class="cell"><input type="radio" name="check_understand" value="3"><span>3</span></label>
        <label class="cell"><input type="radio" name="check_understand" value="4"><span>4</span></label>
        <label class="cell"><input type="radio" name="check_understand" value="5"><span>5</span></label>
        <label class="cell"><input type="radio" name="check_understand" value="6"><span>6</span></label>
        <label class="cell"><input type="radio" name="check_understand" value="7"><span>7</span><span style="font-size:11px;margin-top:2px">å®Œå…¨ç†è§£</span></label>
      </div>
    </div>

    <div class="question-card">
      <div class="qline"><b>2) æˆ‘è¦ºå¾—é€™ä»½èªªæ˜æ¸…æ¥šæ˜“æ‡‚ï¼š</b></div>
      <div class="likert">
        <label class="cell"><input type="radio" name="check_clarity" value="1"><span>1</span><span style="font-size:11px;margin-top:2px">å®Œå…¨ä¸æ¸…æ¥š</span></label>
        <label class="cell"><input type="radio" name="check_clarity" value="2"><span>2</span></label>
        <label class="cell"><input type="radio" name="check_clarity" value="3"><span>3</span></label>
        <label class="cell"><input type="radio" name="check_clarity" value="4"><span>4</span></label>
        <label class="cell"><input type="radio" name="check_clarity" value="5"><span>5</span></label>
        <label class="cell"><input type="radio" name="check_clarity" value="6"><span>6</span></label>
        <label class="cell"><input type="radio" name="check_clarity" value="7"><span>7</span><span style="font-size:11px;margin-top:2px">éå¸¸æ¸…æ¥š</span></label>
      </div>
    </div>

    <button class="btn" id="t3_check_next" style="margin-top:16px">é€²å…¥æœ€å¾Œæ±ºå®š â†’</button>
  </div>
</div>

<!-- T4 -->
<div id="T4" class="card hidden">
  <div class="step-title">T4 æœ€çµ‚æ±ºç­– <span class="pill">ç¬¬å››æ­¥</span></div>
  
  <div class="questions-section">
    <div class="question-card">
      <div class="qline"><b>1) æ•´é«”ä¾†èªªï¼Œä½ è¦ºå¾—é€™å€‹åƒ¹æ ¼æ˜¯å…¬å¹³çš„ï¼š</b></div>
      <div class="likert">
        <label class="cell"><input type="radio" name="t4_fair" value="1"><span>1</span><span style="font-size:11px;margin-top:2px">éå¸¸åŒæ„</span></label>
        <label class="cell"><input type="radio" name="t4_fair" value="2"><span>2</span></label>
        <label class="cell"><input type="radio" name="t4_fair" value="3"><span>3</span></label>
        <label class="cell"><input type="radio" name="t4_fair" value="4"><span>4</span><span style="font-size:11px;margin-top:2px">ä¸­ç«‹</span></label>
        <label class="cell"><input type="radio" name="t4_fair" value="5"><span>5</span></label>
        <label class="cell"><input type="radio" name="t4_fair" value="6"><span>6</span></label>
        <label class="cell"><input type="radio" name="t4_fair" value="7"><span>7</span><span style="font-size:11px;margin-top:2px">éå¸¸ä¸åŒæ„</span></label>
      </div>
    </div>

    <div class="question-card">
      <div class="qline"><b>2) ä½ ç¾åœ¨çš„è³¼è²·æ„é¡˜ï¼š</b></div>
      <div class="likert">
        <label class="cell"><input type="radio" name="t4_intent" value="1"><span>1</span><span style="font-size:11px;margin-top:2px">éå¸¸é¡˜æ„</span></label>
        <label class="cell"><input type="radio" name="t4_intent" value="2"><span>2</span></label>
        <label class="cell"><input type="radio" name="t4_intent" value="3"><span>3</span></label>
        <label class="cell"><input type="radio" name="t4_intent" value="4"><span>4</span><span style="font-size:11px;margin-top:2px">ä¸­ç«‹</span></label>
        <label class="cell"><input type="radio" name="t4_intent" value="5"><span>5</span></label>
        <label class="cell"><input type="radio" name="t4_intent" value="6"><span>6</span></label>
        <label class="cell"><input type="radio" name="t4_intent" value="7"><span>7</span><span style="font-size:11px;margin-top:2px">éå¸¸ä¸é¡˜æ„</span></label>
      </div>
    </div>

    <div class="row" style="margin-top:20px">
      <button class="btn" id="btn_checkout">âœ“ æˆ‘æœƒè³¼è²·</button>
      <button class="btn secondary" id="btn_abandon">âœ— æˆ‘ä¸è²·</button>
    </div>
    <div id="done" class="ok hidden" style="margin-top:12px;font-size:16px">âœ“ å·²å®Œæˆ,æ„Ÿè¬ï¼</div>
  </div>
</div>

<script type="module">
  const q=(s)=>document.querySelector(s);
  const show=(id)=>q('#'+id).classList.remove('hidden');
  const hide=(id)=>q('#'+id).classList.add('hidden');
  const getRadio=(name)=>{const el=document.querySelector(`input[name="${name}"]:checked`);return el?Number(el.value):null;};

  const SUPABASE_URL = "https://hcsbwmeseeerugeotsow.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhjc2J3bWVzZWVlcnVnZW90c293Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAyNjA4MjQsImV4cCI6MjA3NTgzNjgyNH0.3CP5szKNc5wMq9L4xO70wxlyMxT3YpK_5gg7i3TAx38";
  import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";
  const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  let SESSION_ID=null;

  async function startSession(){
    const { data, error } = await supabase.from('sessions').insert([{scenario:'hotel'}]).select('session_id').single();
    if(error){ console.log('é€£ç·šå¤±æ•—:'+error.message); return null; }
    SESSION_ID=data.session_id;
    return SESSION_ID;
  }

  async function logSurvey(step,qid,ans=null,txt=null){
    if(!SESSION_ID) return;
    await supabase.from('surveys').insert([{ session_id: SESSION_ID, step, qid, answer_numeric: ans, answer_text: txt }]);
  }

  /* T0 */
  q('#t0_next').addEventListener('click', async ()=>{
    const gender = q('#t0_gender').value;
    const age = q('#t0_age').value;
    if(!gender || !age){ alert('è«‹é¸æ“‡æ€§åˆ¥å’Œå¹´é½¡'); return; }
    hide('T0'); 
    show('T1');
  });

  /* T1 â†’ T2 */
  q('#t1_next').addEventListener('click', async ()=>{
    const desire=getRadio('t1_intent_desire'); 
    const action=getRadio('t1_intent_action');
    const attention=getRadio('attention_check');
    if(desire==null||action==null||attention==null){ alert('è«‹å®Œæˆå…¨éƒ¨é¡Œç›®å–”'); return; }
    await logSurvey('T1','t1_intent_desire',desire,null);
    await logSurvey('T1','t1_intent_action',action,null);
    await logSurvey('T1','attention_check',attention,null);
    hide('T1'); 
    show('T2');
  });

  /* T2 â†’ T3 */
  q('#t2_next').addEventListener('click', async ()=>{
    const locus=getRadio('t2_locus'); 
    const ctrl=getRadio('t2_control'); 
    const upset=getRadio('t2_upset');
    if(locus==null||ctrl==null||upset==null){ alert('è«‹å®Œæˆä¸‰é¡Œå–”'); return; }
    await logSurvey('T2','t2_attrib_locus',locus,null);
    await logSurvey('T2','t2_attrib_control',ctrl,null);
    await logSurvey('T2','t2_emotion_upset',upset,null);
    hide('T2'); 
    show('T3');
  });

  /* T3 â†’ T3_check */
  q('#t3_next').addEventListener('click', async ()=>{
    const fair=getRadio('t3_fair'); 
    const intent=getRadio('t3_intent');
    if(fair==null||intent==null){ alert('è«‹å®Œæˆå…©é¡Œå–”'); return; }
    await logSurvey('T3','t3_fairness',fair,null);
    await logSurvey('T3','t3_intent',intent,null);
    hide('T3'); 
    show('T3_check');
  });

  /* T3_check â†’ T4 */
  q('#t3_check_next').addEventListener('click', async ()=>{
    const understand=getRadio('check_understand'); 
    const clarity=getRadio('check_clarity');
    if(understand==null||clarity==null){ alert('è«‹å®Œæˆå…©é¡Œå–”'); return; }
    await logSurvey('T3','check_understand',understand,null);
    await logSurvey('T3','check_clarity',clarity,null);
    hide('T3_check'); 
    show('T4');
  });

  /* T4 æäº¤ */
  async function submitT4(){
    const fair=getRadio('t4_fair'); 
    const intent=getRadio('t4_intent');
    if(fair==null||intent==null){ alert('è«‹å…ˆå®Œæˆå…©é¡Œ'); return; }
    await logSurvey('T4','t4_overall_fairness',fair,null);
    await logSurvey('T4','t4_final_intent',intent,null);
    q('#done').classList.remove('hidden');
  }

  q('#btn_checkout').addEventListener('click', submitT4);
  q('#btn_abandon').addEventListener('click', submitT4);

  /* å•Ÿå‹• */
  const ok = await startSession();
  show('T0');
</script>
</body>
</html>
